# 🤖 智能自动生成功能使用指南

## 功能概述

智能自动生成功能是税务知识管理系统的核心增强功能，能够基于爬虫检测到的政策更新自动生成相应的知识库条目和问答对，大大提高了内容维护的效率。

## 🚀 主要特性

### 1. 基于爬虫结果的智能生成
- 自动分析爬虫检测到的政策更新
- 根据更新类型生成相应的知识条目
- 智能分类和关键词提取

### 2. 多种生成模式
- **知识库生成**: 专门生成知识库条目
- **问答库生成**: 专门生成问答对
- **同时生成**: 一键生成知识库和问答库内容

### 3. 智能内容模板
- 政策变更模板
- 新规定发布模板  
- 税率调整模板
- 自动适配不同税务分类

## 📋 使用方法

### 通过Web界面使用

1. **访问后端管理界面**
   ```
   http://localhost:8000
   ```

2. **找到"智能自动生成"卡片**
   - 位于主仪表板中
   - 显示生成统计信息

3. **选择生成模式**
   - 点击"📚 生成知识库"：仅生成知识库内容
   - 点击"💬 生成问答库"：仅生成问答库内容  
   - 点击"🚀 同时生成知识库和问答库"：一键生成所有内容

4. **查看生成结果**
   - 系统会显示生成的条目数量
   - 自动刷新统计数据

### 通过API调用

#### 1. 生成知识库内容
```bash
curl -X POST http://localhost:8000/api/auto-generate/knowledge
```

#### 2. 生成问答库内容
```bash
curl -X POST http://localhost:8000/api/auto-generate/qa
```

#### 3. 同时生成知识库和问答库
```bash
curl -X POST http://localhost:8000/api/auto-generate/both
```

#### 4. 获取生成统计
```bash
curl http://localhost:8000/api/auto-generate/stats
```

## 📊 生成内容示例

### 知识库条目示例
```json
{
  "id": "kb_auto_12345678",
  "title": "增值税政策变更通知（2024年12月）",
  "content": "根据最新政策变更，增值税相关规定已作出调整...",
  "category": "增值税",
  "keywords": ["政策变更", "税率调整", "计算方法", "增值税"],
  "auto_generated": true,
  "source": "自动生成-2024-12-19T10:30:00"
}
```

### 问答对示例
```json
{
  "id": "qa_auto_87654321", 
  "question": "增值税政策变更的主要内容是什么？",
  "answer": "根据增值税相关规定，纳税人应按照新的政策要求进行申报和缴税...",
  "category": "增值税",
  "confidence": 0.89,
  "auto_generated": true
}
```

## ⚙️ 工作流程

1. **爬虫检测更新**
   - 系统定期检查HTML文件变化
   - 模拟在线政策更新检测

2. **内容分析**
   - 分析更新类型（政策变更、新规定、税率调整等）
   - 提取关键信息和分类

3. **智能生成**
   - 基于模板生成结构化内容
   - 自动分配ID、时间戳等元数据

4. **数据存储**
   - 自动添加到相应的数据库
   - 记录生成日志和统计信息

## 🔧 配置选项

### 生成模板配置
在 `modules/auto_generator.py` 中可以自定义：

- **知识模板**: `knowledge_templates`
- **问答模板**: `qa_templates`  
- **分类映射**: `categories`
- **关键词模板**: `keywords_templates`

### 生成数量控制
```python
# 知识库条目生成数量（1-2个）
num_items = random.randint(1, 2)

# 问答条目生成数量（1-3个）
num_items = random.randint(1, 3)
```

## 📈 统计信息

系统提供详细的生成统计：

- **总生成次数**: 累计执行自动生成的次数
- **知识库条目生成**: 累计生成的知识库条目数
- **问答库条目生成**: 累计生成的问答对数
- **最后生成时间**: 最近一次生成的时间

## 🔄 系统重置

当执行系统重置时，自动生成器也会被重置：

1. **清空生成日志**
2. **重置统计数据**
3. **恢复默认知识库和问答库**

## 🛠️ 故障排除

### 常见问题

1. **生成数量为0**
   - 检查爬虫是否检测到更新
   - 运行爬虫检查：`POST /api/crawler/check`

2. **生成内容质量不佳**
   - 调整生成模板
   - 优化关键词提取逻辑

3. **API调用失败**
   - 检查服务器状态：`GET /api/health`
   - 查看服务器日志

### 调试模式

启用详细日志：
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

## 🔮 未来增强

计划中的功能改进：

1. **机器学习集成**: 使用真实的LLM模型
2. **内容质量评估**: 自动评估生成内容的质量
3. **用户反馈机制**: 收集用户对生成内容的反馈
4. **批量处理**: 支持大批量内容生成
5. **多语言支持**: 支持多种语言的内容生成

## 📞 技术支持

如有问题或建议，请：

1. 查看系统日志：`data/auto_generator_log.json`
2. 检查API文档：`http://localhost:8000/docs`
3. 运行测试脚本：`python test_auto_generator.py`

---

**注意**: 当前版本使用模拟数据进行演示。在生产环境中，建议集成真实的爬虫系统和LLM服务以获得最佳效果。 